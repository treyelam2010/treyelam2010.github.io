<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retro Pong</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #222;
            color: #eee;
            font-family: 'Press Start 2P', cursive;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            text-align: center;
        }
        h1 {
            font-size: 2rem;
            text-transform: uppercase;
            color: #fff;
            margin-bottom: 20px;
        }
        canvas {
            background-color: #000;
            border: 4px solid #fff;
            border-radius: 8px;
            /* Responsive canvas */
            width: 90vw;
            max-width: 800px;
            aspect-ratio: 4 / 3;
        }
    </style>
</head>
<body>
    <h1>Pong</h1>
    <!-- Canvas resolution is set in JS, CSS handles display size -->
    <canvas id="gameCanvas"></canvas>

    <script>
        // --- Game Setup ---
        
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        
        // Set the internal resolution of the canvas
        canvas.width = 800;
        canvas.height = 600;
        

        // --- Game Constants ---
        const paddleWidth = 15;
        const paddleHeight = 100;
        const ballSize = 15;
        // --- Game State Variables ---
         // Object to store pressed keys
        let playerPaddle = createPlayerPaddle();
        let aiPaddle = createAiPaddle();
        let ball = createBall();
        let playerScore = 0;
        let aiScore = 0;

        // --- Game Objects (Factories) ---
        function createPlayerPaddle(){
        return{
            x: 10,
            y: canvas.height / 2 - paddleHeight / 2,
            width: paddleWidth,
            height: paddleHeight,
            dy: 0 // Direction of y-movement
        };
        }
        function createAiPaddle(){
        return {
            x: canvas.width - paddleWidth - 10,
            y: canvas.height / 2 - paddleHeight / 2,
            width: paddleWidth,
            height: paddleHeight,
            dy: 0
        };
        }
        function createBall(){
        return{
            x: canvas.width / 2 - ballSize / 2,
            y: canvas.height / 2 - ballSize / 2,
            width: ballSize,
            height: ballSize,
            dx: 5, // Direction of x-movement
            dy: 5  // Direction of y-movement
        };
        }
        function moveBall() {
            ball.x += ball.dx;
            ball.y += ball.dy;
            if (ball.y + ball.dy < 0 || ball.y + ball.dy > canvas.height - ball.height) {
                ball.dy = -ball.dy; // Reverse the y-direction
            }
                    // Check for paddle collisions
        if (isColliding(ball, playerPaddle) || isColliding(ball, aiPaddle)) {
            ball.dx = -ball.dx; // Reverse the x-direction

            // Optional: Add a "ping" sound effect here!
            // var ping = new Audio('ping.mp3');
            // ping.play();
        }
        }
       
        
        // --- Update Functions ---
        
        
        
        
        
        // Wall collision (Top/Bottom)
        
        // Paddle collision
        function movePlayerPaddle() {
            if (keys['ArrowUp']) {
                playerPaddle.y -= 5;
            }
            if (keys['ArrowDown']) {
                    playerPaddle.y += 5;
            }

            // Prevent paddle from going off-screen
            if (playerPaddle.y < 0) {
                playerPaddle.y = 0;
            }
            if (playerPaddle.y + playerPaddle.height > canvas.height) {
                playerPaddle.y = canvas.height - playerPaddle.height;
            }
        }
        function isColliding(rect1, rect2) {
            return (
                rect1.x < rect2.x + rect2.width &&
                rect1.x + rect1.width > rect2.x &&
                rect1.y < rect2.y + rect2.height &&
                rect1.y + rect1.height > rect2.y
            );
        }

                // Optional: Increase speed slightly
            ball.dx *= 1.05; 
            ball.dy *= 1.05;
        
            // Score check
        

        // --- Collision Utility ---
        

        // --- Game State ---
        

        
            // Start the game loop
        
        // --- Main Game Loop ---
        function gameLoop() {
        update();
        draw();
        requestAnimationFrame(gameLoop);
        }
    
        // This function will move the ball and paddles
        function update() {
            moveBall();
            movePlayerPaddle();
            moveAiPaddle();
            if (ball.x < 0) {
            // AI scored
            aiScore++;
            resetBall();
        } else if (ball.x + ball.width > canvas.width) {
            // Player scored
            playerScore++;
            resetBall();
        }
        }
        function moveAiPaddle() {
            // Find the center of the AI paddle
            const aiPaddleCenter = aiPaddle.y + aiPaddle.height / 2;

            // Make the paddle move towards the ball's y-position
            // The "0.1" makes it move slowly and a bit imperfectly, so it can be beaten
            const speed = 4;
            if (aiPaddleCenter < ball.y - 10) {
                aiPaddle.y += speed;
            } else if (aiPaddleCenter > ball.y + 10) {
                aiPaddle.y -= speed;
            }

            // Prevent paddle from going off-screen
            if (aiPaddle.y < 0) {
                aiPaddle.y = 0;
            }
            if (aiPaddle.y + aiPaddle.height > canvas.height) {
                aiPaddle.y = canvas.height - aiPaddle.height;
            }
        }
        // --- Drawing Functions ---
            // 1. Clear the canvas
            function draw() {
                ctx.fillStyle = 'black';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
             

            // 2. Draw Score & Middle Line
           function drawScore() {
                ctx.fillStyle = 'white';
                ctx.font = '35px "Press Start 2P"'; // Make sure to link this font in your HTML!
                ctx.fillText(playerScore, canvas.width / 4, 50);
                ctx.fillText(aiScore, 3 * canvas.width / 4, 50);

                // Draw a dotted line down the middle
                ctx.strokeStyle = 'white';
                ctx.lineWidth = 4;
                ctx.setLineDash([10, 10]);
                ctx.beginPath();
                ctx.moveTo(canvas.width / 2, 0);
                ctx.lineTo(canvas.width / 2, canvas.height);
                ctx.stroke();
                ctx.setLineDash([]); // Reset line dash
            } 
            drawScore();
            // 3. Draw Player Paddle
                ctx.fillStyle = 'white';
                ctx.fillRect(playerPaddle.x, playerPaddle.y, playerPaddle.width, playerPaddle.height);
            // 4. Draw AI Paddle
                ctx.fillRect(aiPaddle.x, aiPaddle.y, aiPaddle.width, aiPaddle.height);
            // 5. Draw Ball
                ctx.fillRect(ball.x, ball.y, ball.width, ball.height);
            }
            function resetBall() {
                ball.x = canvas.width / 2 - ballSize / 2;
                ball.y = canvas.height / 2 - ballSize / 2;

                // Give the ball a random y-direction to start
                ball.dx = -ball.dx; // Change direction so the other player serves
                ball.dy = (Math.random() > 0.5 ? 1 : -1) * 5;
            }

        // Draw dotted line

        // --- Event Listeners ---
        const keys = {};

        document.addEventListener('keydown', (event) => {
            keys[event.key] = true; // Mark the key as pressed
        });

        document.addEventListener('keyup', (event) => {
            keys[event.key] = false; // Mark the key as released
        });


        // --- Start Game ---
        requestAnimationFrame(gameLoop);
    </script>
</body>
</html>


